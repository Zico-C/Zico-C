import{r as c,aO as f,aP as u,j as e}from"./index-59c7084a.js";import{u as b}from"./useQuery-c609bfad.js";import{s as d}from"./page8_01.module-ad5c13d7.js";const g=async()=>await(await fetch("http://localhost:3005/posts")).json(),P=async({id:s,title:o,subtitle:n,author:a,memberNum:r})=>await(await fetch("http://localhost:3005/posts",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({id:s,title:o,subtitle:n,author:a,memberNum:r})})).json(),C=async s=>await(await fetch(`http://localhost:3005/posts/${s}`,{method:"DELETE",headers:{"content-type":"application/json"}})).json();function T(){const[s,o]=c.useState(""),[n,a]=c.useState(""),{data:r,isSuccess:l}=b(["posts"],g),i=f(),h=u(P,{onSuccess:t=>{i.invalidateQueries("posts"),console.log("創建Post成功",t)},onError:t=>{console.log("創建Post失敗",t)},onSettled:()=>{console.log("創建Post操作成功")}}),p=u(C,{onSuccess:t=>{i.invalidateQueries("posts"),console.log("刪除成功",t)},onError:t=>{console.error("刪除失敗",t)},onSettled:()=>{console.log("刪除操作完成")}});function m(){return Math.floor(Math.random()*1e5)+Date.now()}const j=m(),x=()=>{h.mutate({id:0,title:s,subtitle:n,author:"ZICO",memberNum:j}),o(""),a("")},y=t=>{p.mutate(t)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:d.main,children:[e.jsxs("form",{children:[e.jsx("input",{type:"text",placeholder:"title",value:s,onChange:t=>o(t.target.value)}),e.jsx("input",{type:"text",placeholder:"subTitle",value:n,onChange:t=>a(t.target.value)})]}),l&&r.map(t=>e.jsxs("div",{children:[e.jsxs("p",{children:["id：",t.id]}),e.jsxs("p",{children:["title：",t.title]}),e.jsxs("p",{children:["subTitle：",t.subtitle]}),e.jsxs("p",{children:["author：",t.author]}),e.jsxs("p",{children:["memberNum：",t.memberNum]}),e.jsx("button",{onClick:()=>y(t.id),className:d.delete,children:"Delete Post"}),e.jsx("hr",{color:"red"})]},t.id)),e.jsx("button",{onClick:x,children:"Create Post"})]})})}export{T as default};
