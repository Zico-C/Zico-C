import{g as _,K as L,c as G,d as A,r as a,C as B,e as $,o as H,i as F,f as P,j as e,a as R}from"./index-72b56ee1.js";import V from"./Page3_03-e69668e7.js";import{u as W}from"./useQuery-e103b58e.js";import{M as Y,T as Z,d as U,a as J,b as K,P as Q,l as q}from"./index-5ada751e.js";import{C as M,M as k}from"./index-9d157bb1.js";import{G as tt,r as et,M as O}from"./index.esm-1054b931.js";import{R as it,C as T}from"./row-f9270757.js";import"./index-286e4df4.js";function nt(t,s,n){var o=n||{},l=o.noTrailing,u=l===void 0?!1:l,x=o.noLeading,j=x===void 0?!1:x,z=o.debounceMode,y=z===void 0?void 0:z,d,h=!1,C=0;function p(){d&&clearTimeout(d)}function b(v){var i=v||{},r=i.upcomingOnly,m=r===void 0?!1:r;p(),h=!m}function D(){for(var v=arguments.length,i=new Array(v),r=0;r<v;r++)i[r]=arguments[r];var m=this,g=Date.now()-C;if(h)return;function f(){C=Date.now(),s.apply(m,i)}function w(){d=void 0}!j&&y&&!d&&f(),p(),y===void 0&&g>t?j?(C=Date.now(),u||(d=setTimeout(y?w:f,t))):f():u!==!0&&(d=setTimeout(y?w:f,y===void 0?t-g:t))}return D.cancel=b,D}function st(t,s,n){var o=n||{},l=o.atBegin,u=l===void 0?!1:l;return nt(t,s,{debounceMode:u!==!1})}const ot=new L("antSpinMove",{to:{opacity:1}}),at=new L("antRotate",{to:{transform:"rotate(405deg)"}}),lt=t=>({[`${t.componentCls}`]:Object.assign(Object.assign({},A(t)),{position:"absolute",display:"none",color:t.colorPrimary,fontSize:0,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${t.motionDurationSlow} ${t.motionEaseInOutCirc}`,"&-spinning":{position:"static",display:"inline-block",opacity:1},"&-nested-loading":{position:"relative",[`> div > ${t.componentCls}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:t.contentHeight,[`${t.componentCls}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:-t.dotSize/2},[`${t.componentCls}-text`]:{position:"absolute",top:"50%",width:"100%",paddingTop:(t.dotSize-t.fontSize)/2+2,textShadow:`0 1px 2px ${t.colorBgContainer}`,fontSize:t.fontSize},[`&${t.componentCls}-show-text ${t.componentCls}-dot`]:{marginTop:-(t.dotSize/2)-10},"&-sm":{[`${t.componentCls}-dot`]:{margin:-t.dotSizeSM/2},[`${t.componentCls}-text`]:{paddingTop:(t.dotSizeSM-t.fontSize)/2+2},[`&${t.componentCls}-show-text ${t.componentCls}-dot`]:{marginTop:-(t.dotSizeSM/2)-10}},"&-lg":{[`${t.componentCls}-dot`]:{margin:-(t.dotSizeLG/2)},[`${t.componentCls}-text`]:{paddingTop:(t.dotSizeLG-t.fontSize)/2+2},[`&${t.componentCls}-show-text ${t.componentCls}-dot`]:{marginTop:-(t.dotSizeLG/2)-10}}},[`${t.componentCls}-container`]:{position:"relative",transition:`opacity ${t.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:t.colorBgContainer,opacity:0,transition:`all ${t.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${t.componentCls}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none","&::after":{opacity:.4,pointerEvents:"auto"}}},"&-tip":{color:t.spinDotDefault},[`${t.componentCls}-dot`]:{position:"relative",display:"inline-block",fontSize:t.dotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:(t.dotSize-t.marginXXS/2)/2,height:(t.dotSize-t.marginXXS/2)/2,backgroundColor:t.colorPrimary,borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:ot,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:at,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"}},[`&-sm ${t.componentCls}-dot`]:{fontSize:t.dotSizeSM,i:{width:(t.dotSizeSM-t.marginXXS/2)/2,height:(t.dotSizeSM-t.marginXXS/2)/2}},[`&-lg ${t.componentCls}-dot`]:{fontSize:t.dotSizeLG,i:{width:(t.dotSizeLG-t.marginXXS)/2,height:(t.dotSizeLG-t.marginXXS)/2}},[`&${t.componentCls}-show-text ${t.componentCls}-text`]:{display:"block"}})}),rt=_("Spin",t=>{const s=G(t,{spinDotDefault:t.colorTextDescription});return[lt(s)]},t=>({contentHeight:400,dotSize:t.controlHeightLG/2,dotSizeSM:t.controlHeightLG*.35,dotSizeLG:t.controlHeight}));var ct=globalThis&&globalThis.__rest||function(t,s){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&s.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,o=Object.getOwnPropertySymbols(t);l<o.length;l++)s.indexOf(o[l])<0&&Object.prototype.propertyIsEnumerable.call(t,o[l])&&(n[o[l]]=t[o[l]]);return n};let E=null;function dt(t,s){const{indicator:n}=s,o=`${t}-dot`;return n===null?null:F(n)?P(n,{className:$(n.props.className,o)}):F(E)?P(E,{className:$(E.props.className,o)}):a.createElement("span",{className:$(o,`${t}-dot-spin`)},a.createElement("i",{className:`${t}-dot-item`,key:1}),a.createElement("i",{className:`${t}-dot-item`,key:2}),a.createElement("i",{className:`${t}-dot-item`,key:3}),a.createElement("i",{className:`${t}-dot-item`,key:4}))}function pt(t,s){return!!t&&!!s&&!isNaN(Number(s))}const mt=t=>{const{spinPrefixCls:s,spinning:n=!0,delay:o=0,className:l,rootClassName:u,size:x="default",tip:j,wrapperClassName:z,style:y,children:d,hashId:h}=t,C=ct(t,["spinPrefixCls","spinning","delay","className","rootClassName","size","tip","wrapperClassName","style","children","hashId"]),[p,b]=a.useState(()=>n&&!pt(n,o));a.useEffect(()=>{if(n){const c=st(o,()=>{b(!0)});return c(),()=>{var S;(S=c==null?void 0:c.cancel)===null||S===void 0||S.call(c)}}b(!1)},[o,n]);const D=a.useMemo(()=>typeof d<"u",[d]),{direction:v,spin:i}=a.useContext(B),r=$(s,i==null?void 0:i.className,{[`${s}-sm`]:x==="small",[`${s}-lg`]:x==="large",[`${s}-spinning`]:p,[`${s}-show-text`]:!!j,[`${s}-rtl`]:v==="rtl"},l,u,h),m=$(`${s}-container`,{[`${s}-blur`]:p}),g=H(C,["indicator","prefixCls"]),f=Object.assign(Object.assign({},i==null?void 0:i.style),y),w=a.createElement("div",Object.assign({},g,{style:f,className:r,"aria-live":"polite","aria-busy":p}),dt(s,t),j&&D?a.createElement("div",{className:`${s}-text`},j):null);return D?a.createElement("div",Object.assign({},g,{className:$(`${s}-nested-loading`,z,h)}),p&&a.createElement("div",{key:"loading"},w),a.createElement("div",{className:m,key:"container"},d)):w},X=t=>{const{prefixCls:s}=t,{getPrefixCls:n}=a.useContext(B),o=n("spin",s),[l,u]=rt(o),x=Object.assign(Object.assign({},t),{spinPrefixCls:o,hashId:u});return l(a.createElement(mt,Object.assign({},x)))};X.setDefaultIndicator=t=>{E=t};const N=X;function gt(t){return tt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M3 4v12c0 1.103.897 2 2 2h3.5l3.5 4 3.5-4H19c1.103 0 2-.897 2-2V4c0-1.103-.897-2-2-2H5c-1.103 0-2 .897-2 2zm8 1h2v6h-2V5zm0 8h2v2h-2v-2z"}}]})(t)}var ut=(t=>(t.中山區="中山區",t.中正區="中正區",t.信義區="信義區",t.內湖區="內湖區",t.北投區="北投區",t.南港區="南港區",t.士林區="士林區",t.大同區="大同區",t.大安區="大安區",t.文山區="文山區",t.松山區="松山區",t.臺大公館校區="臺大公館校區",t.萬華區="萬華區",t))(ut||{}),ht=(t=>(t.BeitouDist="Beitou Dist",t.DaanDist="Daan Dist.",t.DatongDist="Datong Dist",t.NTUDist="NTU Dist",t.NangangDist="Nangang Dist",t.NeihuDist="Neihu Dist",t.ShilinDist="Shilin Dist",t.SongshanDist="Songshan Dist",t.WanhuaDist="Wanhua Dist",t.WenshanDist="Wenshan Dist",t.XinyiDist="Xinyi Dist",t.ZhongshanDist="Zhongshan Dist",t.ZhongzhengDist="Zhongzheng Dist",t))(ht||{});const I=({title:t,children:s,bodyStyle:n})=>e.jsx(e.Fragment,{children:e.jsx(M,{title:t,headStyle:{backgroundColor:"#002FA7",color:"white",textAlign:"center"},bodyStyle:{padding:3,height:"303px",userSelect:"text",...n},children:s})});function Dt(){const[t,s]=a.useState({center:[25.035751357120876,121.52047467202769],zoom:12}),[n,o]=a.useState(),[l,u]=a.useState(0),[x,j]=a.useState(0),[z,y]=a.useState(0);a.useEffect(()=>{const i=localStorage.getItem("page3_02-viewport");i&&s(JSON.parse(i))},[]);const d=async()=>{try{return(await R.get("https://tcgbusfs.blob.core.windows.net/dotapp/youbike/v2/youbike_immediate.json")).data}catch(i){console.log(i.message)}},{data:h,status:C,isLoading:p,isFetching:b}=W(["TaipeiYouBike"],d,{refetchOnWindowFocus:!1,keepPreviousData:!0,cacheTime:6e4,staleTime:1/0,refetchInterval:6e4});a.useEffect(()=>{C==="success"&&(console.log("data",h),o(h))},[h]);const D=i=>{localStorage.setItem("page3_02-viewport",JSON.stringify(i))},v=(i,r,m,g)=>q.divIcon({className:"",html:et(e.jsx("div",{children:g==="1"&&r/m>=3?e.jsx(O,{style:{color:"#cf1322",fontSize:"2rem",marginLeft:"-11px",marginTop:"-20px"}}):g==="1"&&r/m>=2?e.jsx(O,{style:{color:"#d48806",fontSize:"2rem",marginLeft:"-11px",marginTop:"-20px"}}):g==="1"?e.jsx(O,{style:{color:"#006400",fontSize:"2rem",marginLeft:"-11px",marginTop:"-20px"}}):g==="0"&&e.jsx(gt,{style:{color:"#dc3545",fontSize:"2rem",marginLeft:"-11px",marginTop:"-20px"}})},i))});return a.useEffect(()=>{const i=n==null?void 0:n.map(c=>c.tot),r=i==null?void 0:i.reduce((c,S)=>c+S+0),m=n==null?void 0:n.map(c=>c.bemp),g=m==null?void 0:m.reduce((c,S)=>c+S+0),f=n==null?void 0:n.map(c=>c.sbi),w=f==null?void 0:f.reduce((c,S)=>c+S+0);console.log(r),u(r),j(g),y(w)},[n]),console.log("youbikeTotNum",l),e.jsxs(e.Fragment,{children:[e.jsxs(it,{children:[e.jsx(T,{xs:24,sm:24,md:24,lg:12,xl:12,xxl:6,children:e.jsx(I,{title:"目前場站所有總停車格",bodyStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:p||b?e.jsx(e.Fragment,{children:e.jsx(N,{})}):e.jsx("h1",{style:{fontSize:"2.5rem",fontWeight:"bold",color:"#002FA7"},children:l})})}),e.jsx(T,{xs:24,sm:24,md:24,lg:12,xl:12,xxl:6,children:e.jsx(I,{title:"目前所有可還空位數",bodyStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:p||b?e.jsx(e.Fragment,{children:e.jsx(N,{})}):e.jsx("h1",{style:{fontSize:"2.5rem",fontWeight:"bold",color:"#002FA7"},children:x})})}),e.jsx(T,{xs:24,sm:24,md:24,lg:12,xl:12,xxl:6,children:e.jsx(I,{title:"目前所有可借車位數",bodyStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:p||b?e.jsx(e.Fragment,{children:e.jsx(N,{})}):e.jsx("h1",{style:{fontSize:"2.5rem",fontWeight:"bold",color:"#002FA7"},children:z})})}),e.jsx(T,{xs:24,sm:24,md:24,lg:12,xl:12,xxl:6,children:e.jsx(I,{title:"Charts4",bodyStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:e.jsx(N,{})})})]}),e.jsx(V,{}),e.jsx(M,{bodyStyle:{margin:0,padding:0,height:"100%"},children:e.jsx("div",{style:{margin:0,padding:0},children:e.jsxs(Y,{viewport:t,onViewportChange:D,style:{height:"calc(55vh - 60px)"},children:[e.jsx(Z,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> 貢獻者',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(U,{disableClusteringAtZoom:18,removeOutsideVisibleBounds:!0,spiderfyDistanceMultiplier:1,showCoverageOnHover:!1,maxClusterRadius:35,children:n==null?void 0:n.map((i,r)=>e.jsxs(J,{position:[i.lat,i.lng],icon:v(r,i.tot,i.sbi,i.act),children:[e.jsx(K,{direction:"bottom",children:i.sna}),e.jsx(Q,{children:e.jsxs(M,{bodyStyle:{display:"inline-block",padding:15},children:[e.jsx(k,{title:i.sna,description:i.sarea,style:{textAlign:"center"}}),e.jsx("hr",{style:{color:"gray",width:"90%",marginTop:"10px"}}),b||p?e.jsx(e.Fragment,{children:e.jsx(N,{style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",height:"171.93800px"}})}):e.jsxs(e.Fragment,{children:[i.tot&&e.jsx(e.Fragment,{children:e.jsxs("p",{children:["場站總停車格：",i.tot]})}),i.sbi>=0&&e.jsx(e.Fragment,{children:e.jsxs("p",{children:["可借車位數：",i.sbi]})}),i.bemp&&e.jsx(e.Fragment,{children:e.jsxs("p",{children:["可還空位數：",i.bemp]})}),i.srcUpdateTime&&e.jsx(e.Fragment,{children:e.jsxs("p",{children:["上次更新時間：",i.srcUpdateTime]})})]})]})})]},r))})]},h)})})]})}export{ut as Sarea,ht as Sareaen,Dt as default};
